<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syst√®me de Gestion des V√©hicules Agricoles</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c5530;
            border-bottom: 3px solid #4a7c59;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #4a7c59;
            border-left: 4px solid #4a7c59;
            padding-left: 15px;
            margin-top: 40px;
        }
        h3 {
            color: #5a8a5a;
            margin-top: 30px;
        }
        h4 {
            color: #6b9b6b;
            margin-top: 25px;
        }
        .overview {
            background-color: #f0f8f0;
            padding: 20px;
            border-left: 5px solid #4a7c59;
            margin-bottom: 30px;
            border-radius: 5px;
        }
        .architecture {
            background-color: #fafafa;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }
        pre {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
        }
        code {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre code {
            background: none;
            padding: 0;
        }
        .scenario {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .scenario::before {
            content: "üìå Sc√©nario : ";
            font-weight: bold;
            color: #856404;
        }
        .workflow {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .workflow-step {
            background-color: #e8f5e8;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid #4a7c59;
        }
        .workflow-step h4 {
            margin-top: 0;
            color: #2c5530;
        }
        .advantages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .advantage {
            background-color: #f0f8f0;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
        }
        .advantage h4 {
            color: #155724;
            margin-top: 0;
        }
        .advantage::before {
            content: "‚úÖ ";
            font-size: 1.2em;
        }
        .future-evolution {
            background-color: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid #2196f3;
            margin: 20px 0;
        }
        .evolution-list {
            list-style: none;
            padding: 0;
        }
        .evolution-list li {
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .evolution-list li::before {
            content: "üîÆ ";
            margin-right: 10px;
        }
        .table-section {
            margin: 30px 0;
            padding: 20px;
            background-color: #fafafa;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        .sql-query {
            background-color: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
        }
        .toc {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 20px;
        }
        .toc > ul {
            padding-left: 0;
        }
        .toc a {
            color: #4a7c59;
            text-decoration: none;
        }
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Syst√®me de Gestion des V√©hicules Agricoles</h1>
        
        <div class="toc">
            <h3>Table des mati√®res</h3>
            <ul>
                <li><a href="#overview">Vue d'ensemble</a></li>
                <li><a href="#architecture">Architecture des Tables</a></li>
                <li><a href="#tables">Description des Tables</a>
                    <ul>
                        <li><a href="#vehicles">Vehicles (V√©hicules)</a></li>
                        <li><a href="#operators">Operators (Op√©rateurs)</a></li>
                        <li><a href="#operation-types">Operation Types (Types de T√¢ches)</a></li>
                        <li><a href="#fields">Fields (Champs)</a></li>
                        <li><a href="#vehicle-operations">Vehicle Operations (Op√©rations des V√©hicules)</a></li>
                        <li><a href="#refuel">Fuel Records (Enregistrements de Carburant)</a></li>
                    </ul>
                </li>
                <li><a href="#workflow">Flux de Travail Typique</a></li>
                <li><a href="#code-examples">Exemples de Code</a></li>
                <li><a href="#reports">Rapports et Analyses</a></li>
                <li><a href="#advantages">Avantages du Syst√®me</a></li>
                <li><a href="#evolution">Prochaines √âvolutions Possibles</a></li>
            </ul>
        </div>

        <section id="overview">
            <h2>Vue d'ensemble</h2>
            <div class="overview">
                <p>Ce syst√®me permet de g√©rer efficacement une flotte de v√©hicules agricoles, en suivant les op√©rations, les op√©rateurs, la consommation de carburant et les performances. Il est con√ßu pour une ferme avec une station de carburant interne utilisant un syst√®me de bons.</p>
            </div>
        </section>

        <section id="architecture">
            <h2>Architecture des Tables</h2>
            <h3>Structure Principale</h3>
            <div class="architecture">
vehicles (v√©hicules) ‚Üê vehicleOperations (op√©rations) ‚Üí operators (op√©rateurs)
    ‚Üì                        ‚Üì                              ‚Üì
refuels (carburant) ‚Üí operationTypes (types de t√¢ches)   fields (champs)
            </div>
        </section>

        <section id="tables">
            <h2>Description des Tables</h2>

            <div id="vehicles" class="table-section">
                <h3>1. Vehicles (V√©hicules)</h3>
                <p><strong>Objectif :</strong> Stocke les informations statiques de chaque v√©hicule de la ferme.</p>
                
                <pre><code>export const vehicles = pgTable('vehicles', {
  id: text('id').primaryKey(),
  vehicleType: vehicleTypeEnum('vehicle_type').notNull(),
  name: text('name').notNull(),
  brand: text('brand').notNull(),
  model: text('model').notNull(),
  year: integer('year_manufactured'),
  serialNumber: text('serial_number').unique(),
  licensePlate: text('license_plate'),
  purchaseDate: date('purchase_date'),
  purchasePrice: numeric('purchase_price', { precision: 12, scale: 2 }),
  status: vehicleStatusEnum('status').default('active'),
  fuelType: fuelTypeEnum('fuel_type').default('diesel'),
  tankCapacity: numeric('fuel_tank_capacity', { precision: 8, scale: 2 }),
  initialHours: numeric('initial_engine_hours', { precision: 10, scale: 2 }),
  initialMileage: numeric('initial_mileage_km', { precision: 10, scale: 2 }),
  notes: text('notes'),
  ...timestamps,
});</code></pre>

                <div class="scenario">
                    Vous achetez un nouveau tracteur John Deere 6120M. Vous l'enregistrez avec toutes ses caract√©ristiques : marque, mod√®le, ann√©e, num√©ro de s√©rie, capacit√© du r√©servoir, etc.
                </div>
            </div>

            <div id="operators" class="table-section">
                <h3>2. Operators (Op√©rateurs)</h3>
                <p><strong>Objectif :</strong> G√®re les informations des conducteurs et op√©rateurs de machines agricoles.</p>
                
                <pre><code>export const operators = pgTable('operators', {
  id: text('id').primaryKey(),
  employeeId: text('employee_id').unique(),
  firstName: text('first_name').notNull(),
  lastName: text('last_name').notNull(),
  phone: text('phone'),
  email: text('email'),
  licenseNumber: text('license_number'),
  licenseExpiry: date('license_expiry'),
  hireDate: date('hire_date'),
  status: operatorStatusEnum('status').default('active'),
  hourlyRate: numeric('hourly_rate', { precision: 8, scale: 2 }),
  ...timestamps,
});</code></pre>

                <div class="scenario">
                    Ahmed est embauch√© comme tractoriste. On enregistre ses informations personnelles, son num√©ro de permis, sa date d'embauche et son taux horaire.
                </div>
            </div>

            <div id="operation-types" class="table-section">
                <h3>3. Operation Types (Types de T√¢ches)</h3>
                <p><strong>Objectif :</strong> D√©finit les diff√©rents types de travaux agricoles et leur consommation estim√©e.</p>
                
                <pre><code>export const operationTypes = pgTable('operation_types', {
  id: text('id').primaryKey(),
  name: text('name').notNull(),
  description: text('description'),
  estimatedFuelConsumptionPerHour: numeric('estimated_fuel_consumption_per_hour', { precision: 6, scale: 2 }),
  ...timestamps,
});</code></pre>

                <div class="scenario">
                    Vous cr√©ez des types de t√¢ches comme "Labour", "Semis", "Pulv√©risation", "R√©colte", chacune avec sa consommation de carburant estim√©e par heure.
                </div>
            </div>

            <div id="fields" class="table-section">
                <h3>4. Fields (Champs)</h3>
                <p><strong>Objectif :</strong> R√©pertorie les diff√©rents champs et parcelles de la ferme.</p>
                
                <pre><code>export const fields = pgTable('fields', {
  id: text('id').primaryKey(),
  name: text('name').notNull(),
  area: numeric('area_hectares', { precision: 8, scale: 2 }),
  description: text('description'),
  ...timestamps,
});</code></pre>

                <div class="scenario">
                    Votre ferme a plusieurs champs : "Champ Nord 25ha", "Parcelle Ouest 15ha", "Champ Sud 30ha". Chaque champ est enregistr√© avec sa superficie.
                </div>
            </div>

            <div id="vehicle-operations" class="table-section">
                <h3>5. Vehicle Operations (Op√©rations des V√©hicules)</h3>
                <p><strong>Objectif :</strong> Enregistre chaque op√©ration effectu√©e par un v√©hicule - c'est le c≈ìur du syst√®me de suivi.</p>
                
                <pre><code>export const vehicleOperations = pgTable('vehicle_operations', {
  id: text('id').primaryKey(),
  vehicleId: text('vehicle_id').references(() => vehicles.id).notNull(),
  operatorId: text('operator_id').references(() => operators.id).notNull(),
  operationTypeId: text('operation_type_id').references(() => operationTypes.id).notNull(),
  fieldId: text('field_id').references(() => fields.id),
  date: date('operation_date').notNull(),
  startTime: timestamp('start_time'),
  endTime: timestamp('end_time'),
  startHours: numeric('start_engine_hours', { precision: 10, scale: 2 }).notNull(),
  endHours: numeric('end_engine_hours', { precision: 10, scale: 2 }),
  startMileage: numeric('start_mileage_km', { precision: 10, scale: 2 }),
  endMileage: numeric('end_mileage_km', { precision: 10, scale: 2 }),
  areaCovered: numeric('area_covered', { precision: 10, scale: 2 }),
  weather: text('weather_conditions'),
  status: operationStatusEnum('status').default('planned'),
  notes: text('notes'),
  ...timestamps,
});</code></pre>

                <div class="scenario">
                    Ahmed utilise le tracteur John Deere pour labourer le Champ Nord. L'op√©ration commence √† 8h00 avec 1250 heures moteur et se termine √† 12h00 avec 1254 heures moteur. Il a couvert 12 hectares.
                </div>
            </div>

            <div id="refuel" class="table-section">
                <h3>6. Fuel Records (Enregistrements de Carburant)</h3>
                <p><strong>Objectif :</strong> Suit tous les pleins de carburant avec le syst√®me de bons internes.</p>
                
                <pre><code>export const refuels = pgTable('fuel_records', {
  id: text('id').primaryKey(),
  vehicleId: text('vehicle_id').references(() => vehicles.id).notNull(),
  operatorId: text('operator_id').references(() => operators.id).notNull(),
  datetime: timestamp('refuel_datetime').notNull(),
  voucherNumber: text('voucher_number'),
  liters: numeric('quantity_liters', { precision: 8, scale: 2 }).notNull(),
  costPerLiter: numeric('cost_per_liter', { precision: 6, scale: 2 }),
  totalCost: numeric('total_cost', { precision: 10, scale: 2 }),
  hoursAtRefuel: numeric('engine_hours_at_refuel', { precision: 10, scale: 2 }),
  mileageAtRefuel: numeric('mileage_at_refuel', { precision: 10, scale: 2 }),
  fuelLevelAfter: numeric('fuel_level_after', { precision: 5, scale: 1 }).default('100'),
  attendant: text('attendant_name'),
  notes: text('notes'),
  ...timestamps,
});</code></pre>

                <div class="scenario">
                    Ahmed pr√©sente le bon "BON-2024-001" √† Karim (responsable de la station interne). Karim donne 45 litres de gasoil au tracteur. Le r√©servoir est maintenant plein (100%).
                </div>
            </div>
        </section>

        <section id="workflow">
            <h2>Flux de Travail Typique</h2>
            
            <div class="workflow">
                <div class="workflow-step">
                    <h4>Matin - Pr√©paration</h4>
                    <ol>
                        <li><strong>Planification :</strong> Cr√©er une op√©ration planifi√©e pour la journ√©e</li>
                        <li><strong>Attribution :</strong> Assigner un op√©rateur et un v√©hicule</li>
                        <li><strong>Carburant :</strong> Si n√©cessaire, faire le plein avec un bon</li>
                    </ol>
                </div>

                <div class="workflow-step">
                    <h4>Pendant le Travail</h4>
                    <ol>
                        <li><strong>D√©but :</strong> Enregistrer l'heure de d√©but et les heures moteur initiales</li>
                        <li><strong>Travail :</strong> L'op√©rateur effectue la t√¢che</li>
                        <li><strong>Fin :</strong> Enregistrer l'heure de fin et les heures moteur finales</li>
                    </ol>
                </div>

                <div class="workflow-step">
                    <h4>Soir - Cl√¥ture</h4>
                    <ol>
                        <li><strong>Rapport :</strong> Mettre √† jour le statut de l'op√©ration (termin√©e)</li>
                        <li><strong>Donn√©es :</strong> Ajouter la superficie couverte et les conditions m√©t√©o</li>
                        <li><strong>Carburant :</strong> Si plein fait dans la journ√©e, enregistrer les d√©tails</li>
                    </ol>
                </div>
            </div>
        </section>

        <section id="code-examples">
            <h2>Exemples de Code</h2>

            <h3>Cr√©er un nouveau v√©hicule</h3>
            <pre><code>const newVehicle = await db.insert(vehicles).values({
  vehicleType: 'tractor',
  name: 'Tracteur-001',
  brand: 'John Deere',
  model: '6120M',
  year: 2020,
  serialNumber: 'JD6120M2020001',
  licensePlate: 'TR-001-MA',
  purchaseDate: '2020-03-15',
  purchasePrice: '850000.00',
  fuelType: 'diesel',
  tankCapacity: '220.00',
  initialHours: '0.00',
  initialMileage: '0.00'
});</code></pre>

            <h3>Enregistrer une op√©ration</h3>
            <pre><code>const operation = await db.insert(vehicleOperations).values({
  vehicleId: 'abc123',
  operatorId: 'xyz789',
  operationTypeId: 'operation001',
  fieldId: 'field001',
  date: '2024-07-13',
  startTime: '2024-07-13 08:00:00',
  endTime: '2024-07-13 12:00:00',
  startHours: '1250.00',
  endHours: '1254.00',
  areaCovered: '12.50',
  weather: 'Ensoleill√©, 25¬∞C',
  status: 'completed'
});</code></pre>

            <h3>Enregistrer un plein de carburant</h3>
            <pre><code>const fuelRecord = await db.insert(refuels).values({
  vehicleId: 'abc123',
  operatorId: 'xyz789',
  datetime: '2024-07-13 07:30:00',
  voucherNumber: 'BON-2024-001',
  liters: '45.00',
  costPerLiter: '12.50',
  totalCost: '562.50',
  hoursAtRefuel: '1250.00',
  fuelLevelAfter: '100.0',
  attendant: 'Karim'
});</code></pre>
        </section>

        <section id="reports">
            <h2>Rapports et Analyses</h2>

            <h3>Consommation par v√©hicule</h3>
            <div class="sql-query">
                <pre><code>SELECT 
  v.name as vehicle_name,
  SUM(fr.quantity_liters) as total_fuel_used,
  COUNT(vo.id) as total_operations,
  SUM(vo.area_covered) as total_area_covered
FROM vehicles v
LEFT JOIN fuel_records fr ON v.id = fr.vehicle_id
LEFT JOIN vehicle_operations vo ON v.id = vo.vehicle_id
WHERE vo.status = 'completed'
GROUP BY v.id, v.name;</code></pre>
            </div>

            <h3>Performance des op√©rateurs</h3>
            <div class="sql-query">
                <pre><code>SELECT 
  CONCAT(o.first_name, ' ', o.last_name) as operator_name,
  COUNT(vo.id) as total_operations,
  SUM(vo.area_covered) as total_area_covered,
  AVG(vo.end_engine_hours - vo.start_engine_hours) as avg_hours_per_operation
FROM operators o
LEFT JOIN vehicle_operations vo ON o.id = vo.operator_id
WHERE vo.status = 'completed'
  AND vo.operation_date >= DATE_SUB(NOW(), INTERVAL 30 DAY)
GROUP BY o.id, o.first_name, o.last_name;</code></pre>
            </div>
        </section>

        <section id="advantages">
            <h2>Avantages du Syst√®me</h2>
            
            <div class="advantages">
                <div class="advantage">
                    <h4>Tra√ßabilit√© Compl√®te</h4>
                    <ul>
                        <li>Qui a utilis√© quel v√©hicule, quand et pour quoi</li>
                        <li>Historique complet de chaque machine</li>
                        <li>Suivi pr√©cis de la consommation de carburant</li>
                    </ul>
                </div>

                <div class="advantage">
                    <h4>Optimisation des Co√ªts</h4>
                    <ul>
                        <li>Analyse de la consommation par v√©hicule et par op√©rateur</li>
                        <li>Identification des machines les plus rentables</li>
                        <li>Planification de la maintenance bas√©e sur les heures r√©elles</li>
                    </ul>
                </div>

                <div class="advantage">
                    <h4>Simplicit√© d'Usage</h4>
                    <ul>
                        <li>Syst√®me de bons simple pour le carburant</li>
                        <li>Interface claire pour les op√©rateurs</li>
                        <li>Rapports automatiques pour la gestion</li>
                    </ul>
                </div>

                <div class="advantage">
                    <h4>√âvolutivit√©</h4>
                    <ul>
                        <li>Structure pr√©par√©e pour des fonctionnalit√©s avanc√©es</li>
                        <li>Possibilit√© d'ajouter GPS, IoT, maintenance pr√©ventive</li>
                        <li>Base solide pour l'expansion future</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="evolution">
            <h2>Prochaines √âvolutions Possibles</h2>
            
            <div class="future-evolution">
                <ul class="evolution-list">
                    <li><strong>Maintenance Pr√©ventive :</strong> Alertes automatiques bas√©es sur les heures moteur</li>
                    <li><strong>G√©olocalisation :</strong> Suivi GPS des v√©hicules et cartographie des champs</li>
                    <li><strong>Application Mobile :</strong> Saisie directe depuis le terrain</li>
                    <li><strong>Int√©gration IoT :</strong> Capteurs pour donn√©es automatiques (carburant, heures moteur)</li>
                    <li><strong>Analyses Pr√©dictives :</strong> IA pour optimiser les op√©rations et pr√©voir les pannes</li>
                </ul>
            </div>
        </section>
    </div>
</body>
</html>